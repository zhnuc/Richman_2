# Rich 大富翁游戏详细测试用例说明

## 📋 文档概述

本文档基于游戏规则详细说明，明确每个测试用例需要验证的具体内容和预期结果。

## 🎮 游戏基础规则

### 地图布局（70个位置）
```
位置布局：
起点 - 位置0 (S)
地段1：位置1-25 (每块地200元)  
道具屋：位置25 (T)
地段2：位置26-31 (每块地500元)
魔法屋：位置32 (M)
地段3：位置33-68 (每块地300元)
礼品屋：位置69 (G)

特殊建筑：
- 医院：位置15 (H) - 住院3天
- 监狱：位置45 (P) - 拘留2天
- 矿地：位置20、60、40、80、60各不同点数奖励
```

### 角色系统
- **4个角色**：钱夫人(红色)、阿土伯(红色)、孙小美(蓝色)、金贝贝(黄色)
- **初始资金**：1000-50000可设置，默认10000
- **初始点数**：200点

### 房产系统
- **地段1（1-25）**：200元/块，升级费用200元/次
- **地段2（26-31）**：500元/块，升级费用500元/次  
- **地段3（33-68）**：300元/块，升级费用300元/次
- **房产等级**：空地 → 茅屋 → 洋房 → 摩天楼
- **过路费计算**：房产价值 × 房产等级
- **出售价格**：投资总额 × 2

## 🧪 详细测试用例规范

### 第一类：基础功能测试（80个）

#### 1.1 游戏启动和角色选择（20个）

**test_startup_001 - 单角色选择测试**
```json
输入命令：
- 设置初始资金：10000
- 选择角色：1（钱夫人）

验证内容：
- 游戏正确启动
- 钱夫人被创建并显示为红色
- 初始资金设置为10000元
- 初始点数设置为200点
- 初始位置在起点（位置0）
- 角色在地图上正确显示

预期JSON状态：
{
  "players": [{
    "index": 0, "name": "Q", "fund": 10000, "credit": 200,
    "location": 0, "alive": true, "color": "red"
  }],
  "game": {"player_count": 1, "current_player": 0}
}
```

**test_startup_002 - 双角色选择测试**
```json
输入命令：
- 设置初始资金：15000
- 选择角色：12（钱夫人+阿土伯）

验证内容：
- 两个角色都被正确创建
- 角色颜色区分正确（都是红色但有区别标识）
- 资金和点数初始化正确
- 玩家轮换机制正确

预期JSON状态：
{
  "players": [
    {"index": 0, "name": "Q", "fund": 15000, "credit": 200},
    {"index": 1, "name": "A", "fund": 15000, "credit": 200}
  ],
  "game": {"player_count": 2, "current_player": 0}
}
```

**test_startup_003-010**：类似测试三角色、四角色、无效选择、重复选择等场景

#### 1.2 基础移动功能（30个）

**test_move_001 - Roll命令基础测试**
```json
输入命令：
- 角色选择：1
- 移动命令：roll

验证内容：
- 掷骰子产生1-6之间的随机数
- 角色按步数顺时针移动
- 移动后位置正确更新
- 移动提示信息正确显示

测试场景：
- 步数1：起点(0) → 位置1
- 步数6：起点(0) → 位置6  
- 边界测试：位置67 + 步数5 = 位置2（环绕）
```

**test_move_002 - Step命令基础测试**
```json
输入命令：
- 角色选择：1
- 移动命令：step 3

验证内容：
- 指定步数移动（3步）
- 位置从0移动到3
- 移动轨迹正确显示
- 不触发其他位置效果

预期结果：
- 当前位置更新为3
- 显示"钱夫人移动了3步，当前位置：3"
```

#### 1.3 基础查询功能（10个）

**test_query_001 - Query命令基础测试**
```json
输入命令：
- 初始化：钱夫人，资金10000，点数200
- 查询命令：query

验证内容：
- 显示当前资金：10000元
- 显示当前点数：200点
- 显示当前位置：0
- 显示拥有房产：无
- 显示道具数量：0

预期输出格式：
=== 游戏状态 ===
玩家数量: 1
玩家0: Q, 资金:10000, 位置:0, 存活:是
当前玩家: 0
游戏状态: 未开始
```

### 第二类：地图系统测试（120个）

#### 2.1 空地购买系统（40个）

**test_land_001 - 地段1空地购买测试**
```json
输入命令：
- 角色选择：1，资金10000
- 移动到位置1：step 1
- 购买空地：buy（或自动触发购买选择）

验证内容：
- 购买确认界面显示："当前位置是空地，是否购买？"
- 显示购买价格：200元
- 购买成功后资金扣除：10000 - 200 = 9800
- 地图显示更新：位置1显示钱夫人标识
- 房产所有权记录正确

预期JSON状态：
{
  "players": [{"fund": 9800, "location": 1}],
  "houses": {"1": {"owner": "Q", "level": 0}}
}
```

**test_land_002 - 地段2空地购买测试**
```json
测试位置：26-31
购买价格：500元/块
验证资金扣除和房产记录
```

**test_land_003 - 地段3空地购买测试**
```json
测试位置：33-68
购买价格：300元/块
验证购买流程和状态更新
```

**test_land_004 - 购买资金不足测试**
```json
输入命令：
- 角色资金：100元
- 移动到位置1（需要200元）
- 尝试购买：buy

验证内容：
- 显示资金不足提示
- 购买失败，资金不变
- 房产状态不变
- 位置保持空地状态
```

#### 2.2 房产升级系统（30个）

**test_upgrade_001 - 空地升级为茅屋测试**
```json
输入命令：
- 拥有位置1的空地
- 移动到位置1
- 升级命令：upgrade 1

验证内容：
- 升级费用扣除：200元（地段1升级费）
- 房产等级从0升级到1
- 地图显示更新：茅屋符号
- 过路费计算更新：200 × 1 = 200元

预期JSON状态：
{
  "houses": {"1": {"owner": "Q", "level": 1}}
}
```

**test_upgrade_002 - 茅屋升级为洋房测试**
```json
前置条件：拥有1级茅屋
升级费用：200元
结果等级：2级洋房
过路费：200 × 2 = 400元
```

#### 2.3 过路费系统（30个）

**test_toll_001 - 地段1过路费计算测试**
```json
测试场景：
- 玩家A拥有位置5的2级洋房
- 玩家B移动经过位置5

验证内容：
- 过路费计算：200（地价）× 2（等级）= 400元
- 玩家B资金扣除400元
- 玩家A资金增加400元
- 过路费提示信息显示

特殊情况测试：
- 房主住院期间：免收过路费
- 房主坐牢期间：免收过路费
- 财神附体状态：免交过路费
```

#### 2.4 房产出售系统（20个）

**test_sell_001 - 房产出售价格计算测试**
```json
测试场景：
- 位置1空地：投资200元，出售价400元
- 位置1一级茅屋：投资400元，出售价800元
- 位置1二级洋房：投资600元，出售价1200元

命令：sell 1

验证内容：
- 出售价格 = 总投资 × 2
- 资金正确增加
- 房产状态重置为空地
- 地图显示恢复原状
```

### 第三类：道具系统测试（100个）

#### 3.1 道具购买系统（30个）

**test_prop_buy_001 - 道具屋进入测试**
```json
输入命令：
- 移动到位置25（道具屋）
- 自动进入道具屋

验证内容：
- 显示道具屋欢迎界面
- 显示道具菜单：
  1. 路障(50点)
  2. 机器娃娃(30点)  
  3. 炸弹(50点)
- 显示当前点数
- 显示购买选项和退出选项(F)

预期界面：
欢迎光临道具屋，请选择您所需要的道具:
1.路障(50点) 2.机器娃娃(30点) 3.炸弹(50点)
当前点数：200
请选择(1-3)或按F退出：
```

**test_prop_buy_002 - 路障购买测试**
```json
输入命令：
- 进入道具屋
- 选择购买：1（路障）

验证内容：
- 点数扣除：200 - 50 = 150点
- 道具数量增加：路障+1
- 购买成功提示显示
- 自动退出道具屋或继续购买选择

预期JSON状态：
{
  "players": [{
    "credit": 150,
    "prop": {"barrier": 1, "total": 1}
  }]
}
```

**test_prop_buy_003 - 点数不足购买测试**
```json
测试场景：
- 当前点数：30点
- 尝试购买路障（50点）

验证内容：
- 显示点数不足提示
- 购买失败，点数不变
- 道具数量不变
- 可选择其他道具或退出
```

#### 3.2 路障使用系统（25个）

**test_block_001 - Block命令基础测试**
```json
输入命令：
- 拥有路障道具1个
- 当前位置：10
- 使用命令：block 5

验证内容：
- 路障放置在当前位置前方5步（位置15）
- 地图显示路障符号：#
- 道具数量减少：路障-1
- 放置成功提示显示

预期效果：
- 其他玩家移动到位置15时被拦截
- 拦截后位置保持不变
- 路障消失（一次性使用）
```

**test_block_002 - 路障放置范围测试**
```json
测试场景：
- 当前位置：10
- 测试放置范围：-10到+10

有效放置测试：
- block 1：位置11 ✓
- block 10：位置20 ✓
- block -5：位置5 ✓

无效放置测试：
- block 15：超出范围 ✗
- block -15：超出范围 ✗
- block 0：当前位置 ✗
```

#### 3.3 炸弹使用系统（25个）

**test_bomb_001 - Bomb命令基础测试**
```json
输入命令：
- 拥有炸弹道具1个
- 当前位置：20
- 使用命令：bomb 3

验证内容：
- 炸弹放置在位置23
- 地图显示炸弹符号：@
- 道具数量减少：炸弹-1
- 放置成功提示显示

预期效果：
- 其他玩家移动到位置23触发爆炸
- 玩家进入住院状态（3天）
- 炸弹消失（一次性使用）
- 住院期间跳过回合
```

#### 3.4 机器娃娃使用系统（20个）

**test_robot_001 - Robot命令基础测试**
```json
输入命令：
- 拥有机器娃娃道具1个
- 当前位置：10
- 前方有路障（位置15）和炸弹（位置18）
- 使用命令：robot

验证内容：
- 清除前方10步内所有道具
- 路障和炸弹被清除
- 地图恢复正常显示
- 机器娃娃数量减少：-1
- 清除成功提示显示

清除范围：位置11-20的所有道具
```

### 第四类：特殊建筑测试（80个）

#### 4.1 道具屋测试（20个）
详见道具购买系统测试

#### 4.2 礼品屋测试（20个）

**test_gift_001 - 礼品屋进入测试**
```json
输入命令：
- 移动到位置69（礼品屋）

验证内容：
- 自动进入礼品屋
- 显示礼品选择界面：
  1. 奖金(2000元)
  2. 点数卡(200点)
  3. 财神(5轮有效)

预期界面：
欢迎来到礼品屋！请选择一份礼品：
1. 奖金(2000元)
2. 点数卡(200点)  
3. 财神(5轮有效)
请选择(1-3)：
```

**test_gift_002 - 奖金礼品测试**
```json
输入命令：
- 进入礼品屋
- 选择：1（奖金）

验证内容：
- 资金增加2000元
- 自动退出礼品屋
- 奖金获得提示显示

预期JSON状态：
{
  "players": [{"fund": 原资金 + 2000}]
}
```

#### 4.3 医院测试（15个）

**test_hospital_001 - 医院住院效果测试**
```json
触发条件：
- 踩到炸弹
- 或移动到位置15（医院）

验证内容：
- 进入住院状态
- 住院天数：3天
- 住院期间跳过所有回合
- 住院状态在地图上显示
- 住院期间免交过路费

预期JSON状态：
{
  "players": [{
    "buff": {"hospital": 3}
  }]
}

住院恢复测试：
- 3天后自动恢复正常
- 恢复后可正常移动
- 状态显示正常
```

#### 4.4 监狱测试（10个）

**test_prison_001 - 监狱拘留效果测试**
```json
触发条件：
- 移动到位置45（监狱）

验证内容：
- 进入拘留状态
- 拘留天数：2天
- 拘留期间跳过回合
- 拘留状态显示
- 拘留期间免交过路费

预期JSON状态：
{
  "players": [{
    "buff": {"prison": 2}
  }]
}
```

#### 4.5 魔法屋测试（15个）

**test_magic_001 - 魔法屋进入测试**
```json
输入命令：
- 移动到位置32（魔法屋）

验证内容：
- 自动进入魔法屋
- 显示魔法选择界面
- 提供魔法选项（具体待游戏规则确定）
- 魔法效果正确应用
```

### 第五类：矿地系统测试（20个）

**test_mine_001 - 矿地1奖励测试（位置20）**
```json
输入命令：
- 移动到位置20

验证内容：
- 自动获得点数奖励：20点
- 点数正确增加
- 奖励提示显示："获得矿地奖励20点"

预期JSON状态：
{
  "players": [{"credit": 原点数 + 20}]
}
```

**test_mine_002-006**：测试其他矿地位置的不同奖励

### 第六类：游戏流程测试（60个）

#### 6.1 完整游戏流程测试（30个）

**test_flow_001 - 双玩家完整游戏流程测试**
```json
测试场景：
- 钱夫人 vs 阿土伯
- 初始资金：各10000元
- 进行完整游戏直到一方破产

验证内容：
- 轮流移动机制正确
- 地产买卖升级正常
- 过路费计算准确
- 道具使用有效
- 特殊建筑效果正确
- 游戏结束判定准确

测试流程（简化）：
1. 钱夫人移动并购买地产
2. 阿土伯移动并购买地产
3. 互相支付过路费
4. 使用道具互相攻击
5. 一方资金耗尽破产
6. 游戏结束，胜利者确定
```

#### 6.2 游戏结束条件测试（30个）

**test_end_001 - 破产条件测试**
```json
测试场景：
- 玩家资金不足支付过路费
- 玩家无房产可出售
- 触发破产条件

验证内容：
- 破产判定正确
- 房产自动回收
- 玩家退出游戏
- 剩余玩家继续游戏
- 最后一人获胜

破产处理流程：
1. 资金不足提示
2. 自动出售所有房产
3. 如仍不足则宣布破产
4. 房产回收为空地
5. 玩家状态设为淘汰
```

### 第七类：边界条件测试（40个）

#### 7.1 数值边界测试（20个）

**test_edge_001 - 资金边界测试**
```json
测试场景：
- 资金为0时的各种操作
- 资金为负数的处理
- 资金上限测试（如有）

验证内容：
- 0资金时无法购买房产
- 负资金时触发破产流程
- 资金计算不会溢出
```

**test_edge_002 - 位置边界测试**
```json
测试场景：
- 位置69 + 步数1 = 位置0（环绕）
- 位置0 - 步数1 = 位置69（反向环绕）

验证内容：
- 位置计算正确环绕
- 不会出现负位置或超出位置
- 环绕时正确触发起点奖励（如有）
```

#### 7.2 输入验证测试（20个）

**test_input_001 - 无效命令测试**
```json
输入命令：
- 无效移动：step abc
- 无效道具：block xyz
- 无效购买：buy 999

验证内容：
- 错误提示友好明确
- 游戏状态不受影响
- 重新提示正确输入格式
```

## 📊 测试数据标准

### JSON状态验证标准
```json
{
  "players": [
    {
      "index": 整数,
      "name": "字符串(Q/A/S/J)",
      "fund": 整数(≥0),
      "credit": 整数(≥0),
      "location": 整数(0-69),
      "alive": 布尔值,
      "prop": {
        "bomb": 整数(0-10),
        "barrier": 整数(0-10),
        "robot": 整数(0-10),
        "total": 整数(0-10)
      },
      "buff": {
        "god": 整数(≥0),
        "prison": 整数(≥0),
        "hospital": 整数(≥0)
      }
    }
  ],
  "houses": {
    "位置编号": {
      "owner": "字符串(Q/A/S/J)",
      "level": 整数(0-3)
    }
  },
  "placed_prop": {
    "bomb": [位置数组],
    "barrier": [位置数组]
  },
  "game": {
    "now_player": 整数,
    "next_player": 整数,
    "started": 布尔值,
    "ended": 布尔值,
    "winner": 整数(-1表示游戏进行中)
  }
}
```

### 测试用例命名规范
```bash
test_模块_序号_简短描述

示例：
test_land_001_empty_land_purchase
test_prop_001_barrier_usage
test_flow_001_complete_two_player_game
```

### 测试优先级
- **P0（关键）**：基础功能、游戏流程
- **P1（重要）**：地产系统、道具系统  
- **P2（一般）**：特殊建筑、边界条件
- **P3（可选）**：性能测试、压力测试

---

**本文档为测试用例编写提供详细指导，确保测试覆盖游戏的所有核心功能和边界情况。**

*文档版本：v1.0*  
*最后更新：2025年9月23日*  
*维护人员：张昊楠*
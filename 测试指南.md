# Rich å¤§å¯Œç¿æ¸¸æˆæµ‹è¯•ç”¨ä¾‹æ’°å†™æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•æ ¹æ®æ¸¸æˆè§„åˆ™æ’°å†™é«˜è´¨é‡çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿æµ‹è¯•è¦†ç›–å…¨é¢ã€å‡†ç¡®å¯é ã€‚

## ğŸƒâ€â™‚ï¸ æ•æ·æµ‹è¯•ç®¡ç†ç³»ç»Ÿ

### æµ‹è¯•çŠ¶æ€ç®¡ç†

ä¸ºäº†æ”¯æŒæ•æ·å¼€å‘ï¼Œé¡¹ç›®å¼•å…¥äº†æ™ºèƒ½æµ‹è¯•çŠ¶æ€ç®¡ç†ç³»ç»Ÿï¼Œå…è®¸æ ¹æ®å¼€å‘è¿›åº¦åŠ¨æ€ç®¡ç†æµ‹è¯•ç”¨ä¾‹çš„æ‰§è¡ŒçŠ¶æ€ã€‚

#### æµ‹è¯•çŠ¶æ€ç±»å‹

| çŠ¶æ€ | æ ‡è®° | è¯´æ˜ | æ‰§è¡Œæƒ…å†µ |
|------|------|------|----------|
| **active** | ğŸŸ¢ | æ´»è·ƒæµ‹è¯•ï¼ŒåŠŸèƒ½å·²å®ç° | æ­£å¸¸æ‰§è¡Œï¼Œå¿…é¡»é€šè¿‡ |
| **pending** | ğŸ”µ | å¾…å®ç°åŠŸèƒ½çš„æµ‹è¯• | è·³è¿‡æ‰§è¡Œï¼Œç­‰å¾…åŠŸèƒ½å®ç° |
| **wip** | ğŸŸ¡ | å¼€å‘ä¸­çš„åŠŸèƒ½æµ‹è¯• | æ‰§è¡Œä½†å…è®¸å¤±è´¥ |
| **disabled** | âš« | å·²ç¦ç”¨çš„æµ‹è¯• | å®Œå…¨è·³è¿‡ï¼Œä¸å‚ä¸ç»Ÿè®¡ |

#### çŠ¶æ€é…ç½®æ–‡ä»¶

æµ‹è¯•çŠ¶æ€é€šè¿‡ `tests/test_status.config` æ–‡ä»¶ç®¡ç†ï¼š

```ini
# æµ‹è¯•çŠ¶æ€é…ç½®æ–‡ä»¶
# ç”¨äºæ ‡è®°å“ªäº›æµ‹è¯•æ˜¯æ´»è·ƒçš„ã€å¾…å®ç°çš„æˆ–è·³è¿‡çš„

# æµ‹è¯•çŠ¶æ€è¯´æ˜:
# active: æ´»è·ƒæµ‹è¯•ï¼Œåº”è¯¥é€šè¿‡
# pending: å¾…å®ç°åŠŸèƒ½ï¼Œæš‚æ—¶è·³è¿‡
# disabled: å·²ç¦ç”¨çš„æµ‹è¯•
# wip: æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½

test_help_001: disabled  # helpå‘½ä»¤åŠŸèƒ½æš‚æ—¶ç¦ç”¨
test_query_001: pending  # queryå‘½ä»¤åŠŸèƒ½å¾…å®ç°
test_startup_001: active # å¯åŠ¨åŠŸèƒ½å·²å®ç°
test_startup_002: active
# ... å…¶ä»–æµ‹è¯•é…ç½®
```

#### æ•æ·æµ‹è¯•å‘½ä»¤

```bash
# è¿è¡Œæ•æ·æµ‹è¯•ï¼ˆåªæ‰§è¡Œactiveå’ŒwipçŠ¶æ€çš„æµ‹è¯•ï¼‰
make test

# è¿è¡Œä¼ ç»Ÿæµ‹è¯•ï¼ˆæ‰§è¡Œæ‰€æœ‰æµ‹è¯•ï¼ŒåŒ…æ‹¬ä¼šå¤±è´¥çš„ï¼‰
make integration_test

# æŸ¥çœ‹å½“å‰æµ‹è¯•çŠ¶æ€é…ç½®
make test_status

# æ ‡è®°æµ‹è¯•çŠ¶æ€
make mark_test TEST=test_name STATUS=pending
make mark_test TEST=test_help_001 STATUS=disabled
make mark_test TEST=test_query_001 STATUS=active
```

#### æ•æ·æµ‹è¯•è¾“å‡ºç¤ºä¾‹

```
ğŸš€ å¼€å§‹è¿è¡Œå¤§å¯Œç¿æ¸¸æˆé›†æˆæµ‹è¯•ï¼ˆæ•æ·æ¨¡å¼ï¼‰
============================================================
ğŸ“‹ æµ‹è¯•åˆ†ç±»ç»Ÿè®¡:
   ğŸŸ¢ æ´»è·ƒæµ‹è¯•: 7
   ğŸŸ¡ å¼€å‘ä¸­æµ‹è¯•: 0
   ğŸ”µ å¾…å®ç°æµ‹è¯•: 1
   âš« ç¦ç”¨æµ‹è¯•: 1

ğŸ“ å¾…å®ç°åŠŸèƒ½çš„æµ‹è¯•ç”¨ä¾‹:
   â³ test_query_001 - ç­‰å¾…åŠŸèƒ½å®ç°

============================================================
ğŸ“Š æ•æ·æµ‹è¯•æ‘˜è¦
============================================================
æ‰§è¡Œæµ‹è¯•æ•°: 7
é€šè¿‡æ•°é‡: 7
å¤±è´¥æ•°é‡: 0
å¾…å®ç°æ•°é‡: 1
ç¦ç”¨æ•°é‡: 1
é€šè¿‡ç‡: 100.0%
âœ… æ‰€æœ‰æ´»è·ƒæµ‹è¯•é€šè¿‡ï¼
```

### æ•æ·å¼€å‘å·¥ä½œæµ

1. **åŠŸèƒ½è®¾è®¡é˜¶æ®µ**ï¼šç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œæ ‡è®°ä¸º `pending`
2. **å¼€å‘å¼€å§‹**ï¼šå°†æµ‹è¯•æ ‡è®°ä¸º `wip`ï¼Œå…è®¸å¤±è´¥
3. **åŠŸèƒ½å®Œæˆ**ï¼šå°†æµ‹è¯•æ ‡è®°ä¸º `active`ï¼Œè¦æ±‚é€šè¿‡
4. **åŠŸèƒ½åºŸå¼ƒ**ï¼šå°†æµ‹è¯•æ ‡è®°ä¸º `disabled`

è¿™æ ·ç¡®ä¿CI/CDæµæ°´çº¿å§‹ç»ˆä¿æŒç»¿è‰²çŠ¶æ€ï¼ŒåŒæ—¶æ¸…æ™°å±•ç¤ºå¼€å‘è¿›åº¦ã€‚

## ğŸ¯ æµ‹è¯•ç”¨ä¾‹æ’°å†™åŸåˆ™

### 1. å®Œæ•´æ€§åŸåˆ™
- æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹å¿…é¡»åŒ…å«å®Œæ•´çš„æ‰§è¡Œæµç¨‹
- ä»æ¸¸æˆå¯åŠ¨åˆ°æ¸¸æˆç»“æŸçš„å®Œæ•´è·¯å¾„
- åŒ…å«æ‰€æœ‰å¿…è¦çš„éªŒè¯ç‚¹

### 2. ç‹¬ç«‹æ€§åŸåˆ™
- æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ç‹¬ç«‹å¯æ‰§è¡Œ
- ä¸ä¾èµ–å…¶ä»–æµ‹è¯•ç”¨ä¾‹çš„ç»“æœ
- æµ‹è¯•ç”¨ä¾‹ä¹‹é—´æ— ç›¸äº’å½±å“

### 3. å‡†ç¡®æ€§åŸåˆ™
- æœŸæœ›è¾“å‡ºå¿…é¡»ä¸å®é™…æ¸¸æˆè¡Œä¸ºä¸€è‡´
- æ•°å€¼è®¡ç®—å¿…é¡»å‡†ç¡®æ— è¯¯
- çŠ¶æ€å˜åŒ–å¿…é¡»æ­£ç¡®åæ˜ 

### 4. å¯ç»´æŠ¤æ€§åŸåˆ™
- æµ‹è¯•ç”¨ä¾‹å‘½åæ¸…æ™°æ˜“æ‡‚
- æµ‹è¯•æè¿°è¯¦ç»†å‡†ç¡®
- ä¾¿äºåç»­ä¿®æ”¹å’Œæ‰©å±•

## ğŸ“ æµ‹è¯•ç”¨ä¾‹æ–‡ä»¶ç»“æ„

### æ ‡å‡†ç›®å½•ç»“æ„
```
tests/integration/test_{åŠŸèƒ½}_{åºå·}/
â”œâ”€â”€ input.txt            # å‘½ä»¤åºåˆ—ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ expected_result.json # æœŸæœ›JSONçŠ¶æ€ï¼ˆå¿…éœ€ï¼‰
â”œâ”€â”€ preset.json         # åˆå§‹çŠ¶æ€ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ output.txt          # å®é™…æ§åˆ¶å°è¾“å‡ºï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼Œè°ƒè¯•ç”¨ï¼‰
â”œâ”€â”€ dump.json           # å®é™…JSONçŠ¶æ€ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”œâ”€â”€ description.txt      # æµ‹è¯•æè¿°ï¼ˆæ¨èï¼‰
â””â”€â”€ tags.txt            # æµ‹è¯•æ ‡ç­¾ï¼ˆæ¨èï¼‰
```

### æ–‡ä»¶å†…å®¹è¦æ±‚

#### input.txt - å‘½ä»¤åºåˆ—
**æ ¼å¼è¦æ±‚**ï¼š
- ç¬¬ä¸€è¡Œï¼šåˆå§‹èµ„é‡‘ï¼ˆå¦‚æœæ²¡æœ‰preset.jsonï¼‰
- ç¬¬äºŒè¡Œï¼šè§’è‰²é€‰æ‹©ï¼ˆ1-4çš„æ•°å­—ç»„åˆï¼‰
- åç»­è¡Œï¼šæ¸¸æˆå‘½ä»¤
- 
- æœ€åä¸€è¡Œï¼šquitï¼ˆé€€å‡ºå‘½ä»¤ï¼‰

**ç¤ºä¾‹**ï¼š
```
10000
1
step 3
query
dump
quit
```

**preset.jsonå­˜åœ¨æ—¶çš„æ ¼å¼**ï¼š
```
dump
quit
```

**æ³¨æ„äº‹é¡¹**ï¼š
- å‘½ä»¤å¿…é¡»å°å†™
- å‚æ•°ç”¨ç©ºæ ¼åˆ†éš”
- æ¯è¡Œä¸€ä¸ªå‘½ä»¤
- å¿…é¡»åŒ…å«quitå‘½ä»¤
- æµ‹è¯•åªéªŒè¯JSONçŠ¶æ€ï¼Œä¸éªŒè¯æ§åˆ¶å°è¾“å‡º
- output.txtæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆï¼Œä»…ä¾›è°ƒè¯•ä½¿ç”¨

#### expected_result.json - æœŸæœ›çŠ¶æ€
**æ ¼å¼è¦æ±‚**ï¼š
- ç¬¦åˆJSONæ ¼å¼è§„èŒƒ
- åŒ…å«å®Œæ•´çš„æ¸¸æˆçŠ¶æ€
- æ•°å€¼å¿…é¡»å‡†ç¡®

**ç¤ºä¾‹**ï¼š
```json
{
    "players": [
        {
            "index": 0,
            "name": "Q",
            "fund": 10000,
            "credit": 0,
            "location": 0,
            "alive": true,
            "prop": {
                "bomb": 0,
                "barrier": 0,
                "robot": 0,
                "total": 0
            },
            "buff": {
                "god": 0,
                "prison": 0,
                "hospital": 0
            }
        }
    ],
    "houses": {
    },
    "placed_prop": {
        "bomb": [],
        "barrier": []
    },
    "game": {
        "now_player": 0,
        "next_player": 1,
        "started": false,
        "ended": false,
        "winner": -1
    }
}
```

**æ³¨æ„äº‹é¡¹**ï¼š
- JSONæ ¼å¼å¿…é¡»æ­£ç¡®
- æ•°å€¼å¿…é¡»å‡†ç¡®
- çŠ¶æ€å¿…é¡»å®Œæ•´
- å­—æ®µå¿…é¡»é½å…¨
- è¿™æ˜¯æµ‹è¯•éªŒè¯çš„å”¯ä¸€æ ‡å‡†
- ä¸dump.jsonè¿›è¡Œç²¾ç¡®æ¯”å¯¹

## ğŸ® å…·ä½“åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹æ’°å†™

### 1. æ¸¸æˆå¯åŠ¨å’Œè§’è‰²é€‰æ‹©æµ‹è¯•

#### æµ‹è¯•ç”¨ä¾‹ï¼štest_startup_001
**åŠŸèƒ½**ï¼šå•è§’è‰²é€‰æ‹©æµ‹è¯•
**ç›®æ ‡**ï¼šéªŒè¯å•ä¸ªè§’è‰²é€‰æ‹©åŠŸèƒ½

**input.txt**ï¼š
```
10000
1
quit
```

**expected_result.json**ï¼š
```
å¤§å¯Œç¿æ¸¸æˆå¯åŠ¨
è¯·è¾“å…¥åˆå§‹èµ„é‡‘: æ¬¢è¿æ¥åˆ°å¤§å¯Œç¿ï¼Œè¯·æŒ‰æ•°å­—é”®é€‰æ‹©ä½ çš„è§’è‰²ï¼š
1.é’±å¤«äºº
2.é˜¿åœŸä¼¯
3.å­™å°ç¾
4.é‡‘è´è´
è¯·è¾“å…¥é€‰æ‹© (1-4): æ‚¨é€‰æ‹©äº†: é’±å¤«äºº

æ¸¸æˆå¼€å§‹ï¼
> æ¸¸æˆç»“æŸ
```

**expected_result.json**ï¼š
```json
{
    "players": [
        {
            "index": 0,
            "name": "Q",
            "fund": 10000,
            "credit": 0,
            "location": 0,
            "alive": true,
            "prop": {
                "bomb": 0,
                "barrier": 0,
                "robot": 0,
                "total": 0
            },
            "buff": {
                "god": 0,
                "prison": 0,
                "hospital": 0
            }
        }
    ],
    "houses": {
    },
    "placed_prop": {
        "bomb": [],
        "barrier": []
    },
    "game": {
        "now_player": 0,
        "next_player": 1,
        "started": false,
        "ended": false,
        "winner": -1
    }
}
```

### 2. ç§»åŠ¨åŠŸèƒ½æµ‹è¯•

#### æµ‹è¯•ç”¨ä¾‹ï¼štest_move_001
**åŠŸèƒ½**ï¼šStepå‘½ä»¤åŸºç¡€æµ‹è¯•
**ç›®æ ‡**ï¼šéªŒè¯Stepå‘½ä»¤çš„ç§»åŠ¨åŠŸèƒ½

**input.txt**ï¼š
```
10000
1
step 3
query
dump
quit
```

**expected_result.json**ï¼š
```
å¤§å¯Œç¿æ¸¸æˆå¯åŠ¨
è¯·è¾“å…¥åˆå§‹èµ„é‡‘: æ¬¢è¿æ¥åˆ°å¤§å¯Œç¿ï¼Œè¯·æŒ‰æ•°å­—é”®é€‰æ‹©ä½ çš„è§’è‰²ï¼š
1.é’±å¤«äºº
2.é˜¿åœŸä¼¯
3.å­™å°ç¾
4.é‡‘è´è´
è¯·è¾“å…¥é€‰æ‹© (1-4): æ‚¨é€‰æ‹©äº†: é’±å¤«äºº

æ¸¸æˆå¼€å§‹ï¼
> é’±å¤«äººç§»åŠ¨äº†3æ­¥ï¼Œå½“å‰ä½ç½®ï¼š3
> === æ¸¸æˆçŠ¶æ€ ===
ç©å®¶æ•°é‡: 1
ç©å®¶0: Q, èµ„é‡‘:10000, ä½ç½®:3, å­˜æ´»:æ˜¯
å½“å‰ç©å®¶: 0
æ¸¸æˆçŠ¶æ€: æœªå¼€å§‹
> æ¸¸æˆçŠ¶æ€å·²ä¿å­˜åˆ°: dump.json
> æ¸¸æˆç»“æŸ
```

**expected_result.json**ï¼š
```json
{
    "players": [
        {
            "index": 0,
            "name": "Q",
            "fund": 10000,
            "credit": 0,
            "location": 3,
            "alive": true,
            "prop": {
                "bomb": 0,
                "barrier": 0,
                "robot": 0,
                "total": 0
            },
            "buff": {
                "god": 0,
                "prison": 0,
                "hospital": 0
            }
        }
    ],
    "houses": {
    },
    "placed_prop": {
        "bomb": [],
        "barrier": []
    },
    "game": {
        "now_player": 0,
        "next_player": 1,
        "started": false,
        "ended": false,
        "winner": -1
    }
}
```

### 3. æˆ¿äº§è´­ä¹°æµ‹è¯•

#### æµ‹è¯•ç”¨ä¾‹ï¼štest_land_001
**åŠŸèƒ½**ï¼šåœ°æ®µ1ç©ºåœ°è´­ä¹°æµ‹è¯•
**ç›®æ ‡**ï¼šéªŒè¯åœ°æ®µ1ç©ºåœ°çš„è´­ä¹°åŠŸèƒ½

**input.txt**ï¼š
```
10000
1
step 1
buy
query
dump
quit
```

**expected_result.json**ï¼š
```
å¤§å¯Œç¿æ¸¸æˆå¯åŠ¨
è¯·è¾“å…¥åˆå§‹èµ„é‡‘: æ¬¢è¿æ¥åˆ°å¤§å¯Œç¿ï¼Œè¯·æŒ‰æ•°å­—é”®é€‰æ‹©ä½ çš„è§’è‰²ï¼š
1.é’±å¤«äºº
2.é˜¿åœŸä¼¯
3.å­™å°ç¾
4.é‡‘è´è´
è¯·è¾“å…¥é€‰æ‹© (1-4): æ‚¨é€‰æ‹©äº†: é’±å¤«äºº

æ¸¸æˆå¼€å§‹ï¼
> é’±å¤«äººç§»åŠ¨äº†1æ­¥ï¼Œå½“å‰ä½ç½®ï¼š1
> å½“å‰ä½ç½®æ˜¯ç©ºåœ°ï¼Œæ˜¯å¦è´­ä¹°ï¼Ÿ(y/n): è´­ä¹°æˆåŠŸï¼èŠ±è´¹200å…ƒ
> === æ¸¸æˆçŠ¶æ€ ===
ç©å®¶æ•°é‡: 1
ç©å®¶0: Q, èµ„é‡‘:9800, ä½ç½®:1, å­˜æ´»:æ˜¯
å½“å‰ç©å®¶: 0
æ¸¸æˆçŠ¶æ€: æœªå¼€å§‹
> æ¸¸æˆçŠ¶æ€å·²ä¿å­˜åˆ°: dump.json
> æ¸¸æˆç»“æŸ
```

**expected_result.json**ï¼š
```json
{
    "players": [
        {
            "index": 0,
            "name": "Q",
            "fund": 9800,
            "credit": 0,
            "location": 1,
            "alive": true,
            "prop": {
                "bomb": 0,
                "barrier": 0,
                "robot": 0,
                "total": 0
            },
            "buff": {
                "god": 0,
                "prison": 0,
                "hospital": 0
            }
        }
    ],
    "houses": {
        "1": {
            "owner": "Q",
            "level": 0
        }
    },
    "placed_prop": {
        "bomb": [],
        "barrier": []
    },
    "game": {
        "now_player": 0,
        "next_player": 1,
        "started": false,
        "ended": false,
        "winner": -1
    }
}
```

### 4. é“å…·ä½¿ç”¨æµ‹è¯•

#### æµ‹è¯•ç”¨ä¾‹ï¼štest_prop_001
**åŠŸèƒ½**ï¼šè·¯éšœä½¿ç”¨æµ‹è¯•
**ç›®æ ‡**ï¼šéªŒè¯è·¯éšœçš„æ”¾ç½®å’Œä½¿ç”¨åŠŸèƒ½

**input.txt**ï¼š
```
10000
1
step 25
buy 1
step 1
block 5
query
dump
quit
```

**expected_result.json**ï¼š
```
å¤§å¯Œç¿æ¸¸æˆå¯åŠ¨
è¯·è¾“å…¥åˆå§‹èµ„é‡‘: æ¬¢è¿æ¥åˆ°å¤§å¯Œç¿ï¼Œè¯·æŒ‰æ•°å­—é”®é€‰æ‹©ä½ çš„è§’è‰²ï¼š
1.é’±å¤«äºº
2.é˜¿åœŸä¼¯
3.å­™å°ç¾
4.é‡‘è´è´
è¯·è¾“å…¥é€‰æ‹© (1-4): æ‚¨é€‰æ‹©äº†: é’±å¤«äºº

æ¸¸æˆå¼€å§‹ï¼
> é’±å¤«äººç§»åŠ¨äº†25æ­¥ï¼Œå½“å‰ä½ç½®ï¼š25
> æ¬¢è¿å…‰ä¸´é“å…·å±‹ï¼Œè¯·é€‰æ‹©æ‚¨æ‰€éœ€è¦çš„é“å…·:
> 1.è·¯éšœ(50ç‚¹) 2.æœºå™¨å¨ƒå¨ƒ(30ç‚¹) 3.ç‚¸å¼¹(50ç‚¹)
> è´­ä¹°æˆåŠŸï¼èŠ±è´¹50ç‚¹
> é’±å¤«äººç§»åŠ¨äº†1æ­¥ï¼Œå½“å‰ä½ç½®ï¼š26
> è·¯éšœæ”¾ç½®æˆåŠŸï¼ä½ç½®ï¼š31
> === æ¸¸æˆçŠ¶æ€ ===
ç©å®¶æ•°é‡: 1
ç©å®¶0: Q, èµ„é‡‘:10000, ä½ç½®:26, å­˜æ´»:æ˜¯
å½“å‰ç©å®¶: 0
æ¸¸æˆçŠ¶æ€: æœªå¼€å§‹
> æ¸¸æˆçŠ¶æ€å·²ä¿å­˜åˆ°: dump.json
> æ¸¸æˆç»“æŸ
```

**expected_result.json**ï¼š
```json
{
    "players": [
        {
            "index": 0,
            "name": "Q",
            "fund": 10000,
            "credit": 0,
            "location": 26,
            "alive": true,
            "prop": {
                "bomb": 0,
                "barrier": 0,
                "robot": 0,
                "total": 1
            },
            "buff": {
                "god": 0,
                "prison": 0,
                "hospital": 0
            }
        }
    ],
    "houses": {
    },
    "placed_prop": {
        "bomb": [],
        "barrier": [31]
    },
    "game": {
        "now_player": 0,
        "next_player": 1,
        "started": false,
        "ended": false,
        "winner": -1
    }
}
```

## ğŸ”§ æµ‹è¯•ç”¨ä¾‹æ’°å†™å·¥å…·

### 1. æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå™¨

```python
#!/usr/bin/env python3
"""
æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå™¨
æ ¹æ®æ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
"""

import os
import json
from pathlib import Path

class TestCaseGenerator:
    def __init__(self, base_dir="tests/integration"):
        self.base_dir = Path(base_dir)
        self.test_counter = 1
    
    def generate_move_test(self, steps):
        """ç”Ÿæˆç§»åŠ¨æµ‹è¯•ç”¨ä¾‹"""
        test_name = f"test_move_{self.test_counter:03d}"
        test_dir = self.base_dir / test_name
        test_dir.mkdir(exist_ok=True)
        
        # ç”Ÿæˆcmdlist.txt
        cmdlist_content = f"""1
step {steps}
query
dump
quit"""
        
        with open(test_dir / "cmdlist.txt", "w", encoding="utf-8") as f:
            f.write(cmdlist_content)
        
        # ç”Ÿæˆexpected_output.txt
        expected_output = f"""å¤§å¯Œç¿æ¸¸æˆå¯åŠ¨
æ¬¢è¿æ¥åˆ°å¤§å¯Œç¿ï¼Œè¯·æŒ‰æ•°å­—é”®é€‰æ‹©ä½ çš„è§’è‰²ï¼š
1.é’±å¤«äºº
2.é˜¿åœŸä¼¯
3.å­™å°ç¾
4.é‡‘è´è´
è¯·è¾“å…¥é€‰æ‹© (1-4): æ‚¨é€‰æ‹©äº†: é’±å¤«äºº
æ¸¸æˆå¼€å§‹ï¼
> é’±å¤«äººç§»åŠ¨äº†{steps}æ­¥ï¼Œå½“å‰ä½ç½®ï¼š{steps}
> === æ¸¸æˆçŠ¶æ€ ===
ç©å®¶æ•°é‡: 1
ç©å®¶0: é’±å¤«äºº, èµ„é‡‘:1500, ä½ç½®:{steps}, å­˜æ´»:æ˜¯
å½“å‰ç©å®¶: 0
æ¸¸æˆçŠ¶æ€: æœªå¼€å§‹
> æ¸¸æˆçŠ¶æ€å·²ä¿å­˜åˆ°: dump.json
> æ¸¸æˆç»“æŸ"""
        
        with open(test_dir / "expected_output.txt", "w", encoding="utf-8") as f:
            f.write(expected_output)
        
        # ç”Ÿæˆexpected_dump.json
        expected_dump = {
            "players": [
                {
                    "index": 0,
                    "name": "é’±å¤«äºº",
                    "fund": 1500,
                    "credit": 0,
                    "location": steps,
                    "alive": True,
                    "prop": {
                        "bomb": 0,
                        "barrier": 0,
                        "robot": 0,
                        "total": 0
                    },
                    "buff": {
                        "god": 0,
                        "prison": 0,
                        "hospital": 0
                    }
                }
            ],
            "houses": {},
            "placed_prop": {
                "bomb": [],
                "barrier": []
            },
            "game": {
                "now_player": 0,
                "next_player": 1,
                "started": False,
                "ended": False,
                "winner": -1
            }
        }
        
        with open(test_dir / "expected_dump.json", "w", encoding="utf-8") as f:
            json.dump(expected_dump, f, indent=4, ensure_ascii=False)
        
        self.test_counter += 1
        return test_name

# ä½¿ç”¨ç¤ºä¾‹
generator = TestCaseGenerator()
for steps in range(1, 7):
    generator.generate_move_test(steps)
```

### 2. æµ‹è¯•ç”¨ä¾‹éªŒè¯å™¨

```python
#!/usr/bin/env python3
"""
æµ‹è¯•ç”¨ä¾‹éªŒè¯å™¨
éªŒè¯æµ‹è¯•ç”¨ä¾‹çš„æ­£ç¡®æ€§
"""

import subprocess
import json
import difflib
from pathlib import Path

class TestValidator:
    def __init__(self, game_binary="./rich"):
        self.game_binary = game_binary
    
    def validate_test_case(self, test_dir):
        """éªŒè¯å•ä¸ªæµ‹è¯•ç”¨ä¾‹"""
        test_dir = Path(test_dir)
        
        # æ£€æŸ¥å¿…éœ€æ–‡ä»¶
        required_files = ["cmdlist.txt", "expected_output.txt", "expected_dump.json"]
        for file in required_files:
            if not (test_dir / file).exists():
                print(f"âŒ ç¼ºå°‘æ–‡ä»¶: {file}")
                return False
        
        # è¿è¡Œæ¸¸æˆç¨‹åº
        cmdlist_file = test_dir / "cmdlist.txt"
        with open(cmdlist_file, 'r', encoding='utf-8') as f:
            cmd_input = f.read()
        
        try:
            result = subprocess.run(
                [self.game_binary],
                input=cmd_input,
                text=True,
                capture_output=True,
                timeout=30
            )
            
            # ä¿å­˜å®é™…è¾“å‡º
            with open(test_dir / "output.txt", "w", encoding="utf-8") as f:
                f.write(result.stdout)
            
            # æ¯”è¾ƒè¾“å‡º
            expected_output_file = test_dir / "expected_output.txt"
            with open(expected_output_file, 'r', encoding='utf-8') as f:
                expected_output = f.read()
            
            if result.stdout.strip() == expected_output.strip():
                print(f"âœ… è¾“å‡ºåŒ¹é…: {test_dir.name}")
                return True
            else:
                print(f"âŒ è¾“å‡ºä¸åŒ¹é…: {test_dir.name}")
                # æ˜¾ç¤ºå·®å¼‚
                diff = difflib.unified_diff(
                    expected_output.splitlines(keepends=True),
                    result.stdout.splitlines(keepends=True),
                    fromfile="æœŸæœ›è¾“å‡º",
                    tofile="å®é™…è¾“å‡º"
                )
                for line in diff:
                    print(line, end="")
                return False
                
        except subprocess.TimeoutExpired:
            print(f"âŒ è¶…æ—¶: {test_dir.name}")
            return False
        except Exception as e:
            print(f"âŒ é”™è¯¯: {test_dir.name} - {e}")
            return False
    
    def validate_all_tests(self, test_dir="tests/integration"):
        """éªŒè¯æ‰€æœ‰æµ‹è¯•ç”¨ä¾‹"""
        test_dir = Path(test_dir)
        passed = 0
        total = 0
        
        for test_case in test_dir.iterdir():
            if test_case.is_dir():
                total += 1
                if self.validate_test_case(test_case):
                    passed += 1
        
        print(f"\nğŸ“Š éªŒè¯ç»“æœ: {passed}/{total} é€šè¿‡")
        return passed == total

# ä½¿ç”¨ç¤ºä¾‹
validator = TestValidator()
validator.validate_all_tests()
```

## ğŸ“‹ æµ‹è¯•ç”¨ä¾‹æ’°å†™æ£€æŸ¥æ¸…å•

### æ’°å†™å‰æ£€æŸ¥
- [ ] ç¡®å®šæµ‹è¯•ç›®æ ‡å’ŒåŠŸèƒ½ç‚¹
- [ ] åˆ†ææ¸¸æˆè§„åˆ™å’Œé¢„æœŸè¡Œä¸º
- [ ] è®¾è®¡æµ‹è¯•åœºæ™¯å’Œå‘½ä»¤åºåˆ—
- [ ] å‡†å¤‡æœŸæœ›è¾“å‡ºå’ŒçŠ¶æ€

### æ’°å†™ä¸­æ£€æŸ¥
- [ ] input.txtæ ¼å¼æ­£ç¡®
- [ ] å‘½ä»¤åºåˆ—å®Œæ•´å¯æ‰§è¡Œ
- [ ] expected_result.jsonçŠ¶æ€æ­£ç¡®æ— è¯¯
- [ ] æµ‹è¯•ç”¨ä¾‹ç‹¬ç«‹å¯è¿è¡Œ
- [ ] åªå…³æ³¨JSONçŠ¶æ€éªŒè¯

### æ’°å†™åæ£€æŸ¥
- [ ] è¿è¡Œæµ‹è¯•ç”¨ä¾‹éªŒè¯
- [ ] éªŒè¯JSONçŠ¶æ€æ­£ç¡®åŒ¹é…
- [ ] ç¡®è®¤æµ‹è¯•ç”¨ä¾‹é€šè¿‡
- [ ] æ£€æŸ¥output.txtè°ƒè¯•ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
- [ ] æ›´æ–°æµ‹è¯•æ–‡æ¡£

## ğŸš€ æœ€ä½³å®è·µ

### 1. æµ‹è¯•ç”¨ä¾‹è®¾è®¡
- ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹åªæµ‹è¯•ä¸€ä¸ªåŠŸèƒ½ç‚¹
- æµ‹è¯•ç”¨ä¾‹è¦ç®€å•æ˜äº†
- é¿å…å¤æ‚çš„æµ‹è¯•åœºæ™¯
- ä¼˜å…ˆæµ‹è¯•æ ¸å¿ƒåŠŸèƒ½

### 2. å‘½ä»¤åºåˆ—è®¾è®¡
- å‘½ä»¤åºåˆ—è¦ç®€æ´æœ‰æ•ˆ
- é¿å…ä¸å¿…è¦çš„å‘½ä»¤
- ç¡®ä¿å‘½ä»¤é¡ºåºæ­£ç¡®
- åŒ…å«å¿…è¦çš„éªŒè¯å‘½ä»¤

### 3. JSONçŠ¶æ€è®¾è®¡
- JSONæ ¼å¼è¦æ­£ç¡®è§„èŒƒ
- æ•°å€¼è¦å‡†ç¡®æ— è¯¯
- çŠ¶æ€è¦å®Œæ•´é½å…¨
- å­—æ®µè¦ä¸å®é™…æ¸¸æˆçŠ¶æ€ä¸€è‡´

### 4. è°ƒè¯•å’Œç»´æŠ¤
- åˆ©ç”¨output.txtæ–‡ä»¶è¿›è¡Œé—®é¢˜æ’æŸ¥
- å¯¹æ¯”dump.jsonå’Œexpected_result.jsonæ‰¾å‡ºå·®å¼‚
- å…³æ³¨æ¸¸æˆé€»è¾‘è€Œéè¾“å‡ºæ ¼å¼
- ä¿æŒæµ‹è¯•ç”¨ä¾‹çš„ç®€æ´æ€§

### 5. æµ‹è¯•ç”¨ä¾‹ç»´æŠ¤
- å®šæœŸæ›´æ–°æµ‹è¯•ç”¨ä¾‹
- åŠæ—¶ä¿®å¤å‘ç°çš„é—®é¢˜
- ä¿æŒæµ‹è¯•ç”¨ä¾‹çš„æ—¶æ•ˆæ€§
- ä¼˜åŒ–æµ‹è¯•ç”¨ä¾‹çš„æ€§èƒ½

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¸¸è§é—®é¢˜
1. **æµ‹è¯•ç”¨ä¾‹ä¸é€šè¿‡æ€ä¹ˆåŠï¼Ÿ**
   - æ£€æŸ¥expected_result.jsonæ˜¯å¦å‡†ç¡®
   - éªŒè¯dump.jsonä¸æœŸæœ›çŠ¶æ€çš„å·®å¼‚
   - ç¡®è®¤å‘½ä»¤åºåˆ—æ˜¯å¦å®Œæ•´
   - æŸ¥çœ‹output.txtäº†è§£ç¨‹åºæ‰§è¡Œè¿‡ç¨‹

2. **å¦‚ä½•ç”ŸæˆæœŸæœ›çŠ¶æ€ï¼Ÿ**
   - è¿è¡Œæ¸¸æˆç¨‹åº
   - æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤åºåˆ—
   - å¤åˆ¶ç”Ÿæˆçš„dump.jsonä¸ºexpected_result.json
   - éªŒè¯çŠ¶æ€çš„æ­£ç¡®æ€§

3. **å¦‚ä½•éªŒè¯JSONçŠ¶æ€ï¼Ÿ**
   - ä½¿ç”¨dumpå‘½ä»¤ä¿å­˜çŠ¶æ€
   - æ£€æŸ¥JSONæ ¼å¼æ˜¯å¦æ­£ç¡®
   - éªŒè¯æ•°å€¼æ˜¯å¦å‡†ç¡®
   - ç¡®è®¤çŠ¶æ€æ˜¯å¦å®Œæ•´

### è·å–å¸®åŠ©
- æŸ¥çœ‹ç°æœ‰æµ‹è¯•ç”¨ä¾‹ä½œä¸ºå‚è€ƒ
- ä½¿ç”¨æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå™¨
- è¿è¡Œæµ‹è¯•ç”¨ä¾‹éªŒè¯å™¨
- åœ¨å›¢é˜Ÿç¾¤ä¸­è®¨è®ºé—®é¢˜

---

**è®°ä½**ï¼šé«˜è´¨é‡çš„æµ‹è¯•ç”¨ä¾‹æ˜¯æ¸¸æˆè´¨é‡çš„é‡è¦ä¿éšœï¼Œè¯·è®¤çœŸå¯¹å¾…æ¯ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹çš„æ’°å†™ï¼